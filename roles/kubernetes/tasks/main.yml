---
#- include: fedora.yml
#  when: is_rhel7.rc != 0

#- include: rhel7.yml
#  when: is_rhel7.rc == 0

- name: Install docker
  yum: pkg=docker state=latest

- name: write the docker config file
  template: src=docker.j2 dest=/etc/sysconfig/docker
  notify:
          - restart daemons

- name: write the docker service file
  template: src=docker.service.j2 dest=/usr/lib/systemd/system/docker.service
  notify:
          - restart daemons

- name: Daemon reload
  command: "systemctl daemon-reload"

- name: Delete docker0
  command: "ip link del docker0"

- name: write the global config file
  template: src=config.j2 dest=/etc/kubernetes/config
  notify:
          - restart daemons

- name: Check kube user
  user: name=kube group=kube home=/data/kube

- name: collect facts about the version of kubernetes
  kube-caps:
  environment:
    PATH: "{{ ansible_env.PATH }}:/opt/bin"
